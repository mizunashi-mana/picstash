# Picstash 実装計画

## 概要

プロダクトを独自の価値を提供するセグメントに分割し、各セグメントを順次実装することで継続的に改善しながら機能を追加していく。

## セグメント一覧（全35セグメント）

### 開発環境整備（6セグメント）

| # | セグメント | 提供価値 | 状態 |
|---|-----------|---------|------|
| 0-1 | モノレポ構成・パッケージ初期化 | プロジェクト構造が整う | 完了 |
| 0-2 | TypeScript・ESLint 設定 | 型安全・コード品質が保証される | 完了 |
| 0-3 | Prisma・DB セットアップ | データ永続化の基盤が整う | 完了 |
| 0-4 | Fastify サーバー基盤 | API サーバーが動く | 完了 |
| 0-5 | React・Vite クライアント基盤 | フロントエンドが動く | 完了 |
| 0-6 | 開発サーバー統合起動 | 開発がスムーズに始められる | 完了 |

### 基盤（5セグメント）

| # | セグメント | 提供価値 | 状態 |
|---|-----------|---------|------|
| 1-1 | 画像アップロード・保存 | 画像を登録できる | 完了 |
| 1-2 | ギャラリー表示 | 登録した画像を一覧で見れる | 完了 |
| 1-3 | サムネイル生成 | 高速に画像一覧を表示できる | 完了 |
| 1-4 | 画像詳細表示 | 画像を大きく見れる | 完了 |
| 1-5 | 画像削除 | 不要な画像を削除できる | 完了 |

### 検索・整理（4セグメント）

| # | セグメント | 提供価値 | 状態 |
|---|-----------|---------|------|
| 2-1 | 属性ラベル管理 | 属性ラベルを作成・編集・削除できる | 完了 |
| 2-2 | 画像属性付与 | 画像に属性（ラベル+複数キーワード）を付けられる | 完了 |
| 2-3 | 画像説明 | 画像に説明文を付けられる | 完了 |
| 2-4 | 検索 | 属性・説明・キーワードで画像を見つけられる | 完了 |

### アーカイブインポート（3セグメント）

| # | セグメント | 提供価値 | 状態 |
|---|-----------|---------|------|
| 3-1 | アーカイブ解析・プレビュー | ZIP/RAR を開いて中身の画像をプレビューできる | 完了 |
| 3-2 | 選択的インポート | 必要な画像だけを選んでライブラリに取り込める | 完了 |
| 3-3 | 7z 形式対応 | 7z アーカイブも開けるようになる | 未着手 |
| 3-4 | LZH 形式対応 | LZH アーカイブも開けるようになる | 未着手 |

### AI 自動化（5セグメント）

| # | セグメント | 提供価値 | 状態 |
|---|-----------|---------|------|
| 4-1 | 画像埋め込みベクトル生成 | AI 機能の基盤が整う | 完了 |
| 4-2 | 自動属性推薦 | 手動属性付け不要になる | 完了 |
| 4-3 | 自動説明生成 | 手動で説明を書かなくてよくなる | 完了 |
| 4-4 | 類似画像検出 | 似た画像をまとめて見れる | 完了 |
| 4-5 | 重複画像検出 | 重複を整理できる | 完了 |

### コレクション（2セグメント）

| # | セグメント | 提供価値 | 状態 |
|---|-----------|---------|------|
| 5-1 | コレクション管理・画像追加 | シリーズをまとめられる | 完了 |
| 5-2 | コレクション連続閲覧 | シリーズを順番に読める | 完了 |

### 閲覧履歴・推薦（4セグメント）

| # | セグメント | 提供価値 | 状態 |
|---|-----------|---------|------|
| 6-1 | 閲覧履歴記録 | 閲覧した画像・滞在時間を自動記録できる | 未着手 |
| 6-2 | 画像推薦 | 閲覧傾向+ベクトルに基づくおすすめが見れる | 未着手 |
| 6-3 | コンバージョン記録 | 推薦クリック・滞在時間を記録し精度向上に活用 | 未着手 |
| 6-4 | 統計ダッシュボード | 閲覧傾向・推薦精度を可視化・分析できる | 未着手 |

### 動画対応（3セグメント）

| # | セグメント | 提供価値 | 状態 |
|---|-----------|---------|------|
| 7-1 | 動画アップロード・サムネイル生成 | 動画をライブラリに追加しサムネイルで一覧表示できる | 未着手 |
| 7-2 | 動画再生 | 詳細画面で動画を再生・操作できる | 未着手 |
| 7-3 | 動画 AI 解析 | 動画のキーフレームから属性・説明を自動推薦できる | 未着手 |

### ネイティブアプリ化（3セグメント）

| # | セグメント | 提供価値 | 状態 |
|---|-----------|---------|------|
| 8-1 | ストレージ抽象化 | ローカル/クラウド切り替えの基盤が整う | 未着手 |
| 8-2 | ローカルストレージ対応 | 指定フォルダに画像・DBを保存できる | 未着手 |
| 8-3 | デスクトップアプリ化 | ネイティブアプリとして動作する | 未着手 |

---

## 実装順序

```
開発環境整備
  0-1 モノレポ構成
   ↓
  0-2 TypeScript・ESLint
   ↓
  0-3 Prisma・DB
   ↓
  0-4 Fastify サーバー
   ↓
  0-5 React・Vite クライアント
   ↓
  0-6 統合起動
   ↓
基盤
  1-1 画像アップロード・保存
   ↓
  1-2 ギャラリー表示
   ↓
  1-3 サムネイル生成
   ↓
  1-4 画像詳細表示
   ↓
  1-5 画像削除
   ↓
検索・整理
  2-1 属性ラベル管理
   ↓
  2-2 画像属性付与
   ↓
  2-3 画像説明
   ↓
  2-4 検索
   ↓
アーカイブインポート
  3-1 アーカイブ解析・プレビュー (ZIP/RAR)
   ↓
  3-2 選択的インポート
   ↓
  3-3 7z 形式対応
   ↓
  ┌─────────────────┬─────────────────┐
  ↓                 ↓
AI 自動化         コレクション
  4-1 ベクトル生成    5-1 管理・追加
   ↓                 ↓
  4-2 自動属性        5-2 連続閲覧
   ↓
  4-3 自動説明
   ↓
  4-4 類似検出
   ↓
  4-5 重複検出
   ↓
閲覧履歴・推薦
  6-1 閲覧履歴記録
   ↓
  6-2 画像推薦
   ↓
  6-3 コンバージョン記録
   ↓
  6-4 統計ダッシュボード
   ↓
動画対応
  7-1 動画アップロード・サムネイル
   ↓
  7-2 動画再生
   ↓
  7-3 動画 AI 解析
   ↓
ネイティブアプリ化
  8-1 ストレージ抽象化
   ↓
  8-2 ローカルストレージ
   ↓
  8-3 デスクトップアプリ
```

---

## 各セグメントの進め方

### 基本方針
- **対話的に進める**: 各ステップでユーザーと確認しながら実装
- **早めのフィードバック**: 動くものを早く見せて方向修正
- **小さく作って確認**: 一度に大きく作らず、小さな単位で確認

### イテレーションサイクル

```
1. 計画確認
   - 次に作るものを確認
   - 不明点があれば質問
          ↓
2. 最小実装
   - 動く最小限を実装
   - 完璧を目指さない
          ↓
3. デモ・確認
   - 動作を見せてフィードバックをもらう
   - 方向修正があれば即反映
          ↓
4. 改善・次へ
   - フィードバックを反映
   - 次の機能へ進む
```

### 確認タイミング
- データモデル設計後
- API 実装後（curl などで動作確認）
- UI の骨組み完成後
- 各機能の実装完了後
