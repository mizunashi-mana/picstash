# desktop-app E2E テスト拡充

## 目的・ゴール

Electron Playwright MCP を使って動作確認しながら、desktop-app の E2E テストを拡充し、基本的なユースケースをカバーする。

## 現状

- 既存の E2E テスト (`tests/e2e/app.spec.ts`):
  - アプリ起動確認
  - プリロードスクリプト検証
  - セキュリティ設定確認
  - ストレージ選択画面の表示

## 追加したテストケース

### 1. ナビゲーション (`navigation.spec.ts`) - 10 テスト
- [x] サイドバーナビゲーションの動作確認（8ページへの遷移）
- [x] ナビゲーションリンクのアクティブ状態
- [x] サイドバーの折りたたみ/展開

### 2. ギャラリー (`gallery.spec.ts`) - 7 テスト
- [x] ギャラリーページの表示
- [x] 検索バーの表示
- [x] ビュー切り替えボタンの動作
- [x] 画像カウントの表示
- [x] 検索機能（入力、ボタンクリック、Enter キー）

### 3. コレクション (`collections.spec.ts`) - 5 テスト
- [x] コレクションページの表示
- [x] 新規コレクションボタンの表示
- [x] 空状態/リスト表示の確認
- [x] モーダルの開閉
- [x] コレクション作成

### 4. ラベル (`labels.spec.ts`) - 6 テスト
- [x] ラベルページの表示
- [x] ラベル作成フォームの表示
- [x] ラベル一覧の表示
- [x] ラベル作成
- [x] 複数ラベルの作成

### 5. インポート (`import.spec.ts`) - 10 テスト
- [x] インポートページの表示
- [x] タブの表示と切り替え（画像、アーカイブ、URL）
- [x] 画像タブのデフォルト選択
- [x] ドロップゾーンの表示
- [x] ファイル選択機能

## 実装方針

1. Electron Playwright MCP でアプリを起動し、実際の動作を確認しながらテストを作成
2. 既存の `app.spec.ts` をベースに、ユースケース別のテストファイルを追加
3. テストデータはテスト専用ディレクトリを使用（各テストファイルで独立したディレクトリ）
4. テスト間の状態依存を避けるため、動的な値（タイムスタンプなど）を使用

## 完了条件

- [x] 基本的なユースケースの E2E テストが追加されている
- [x] `npm run test:e2e -w @picstash/desktop-app` で全テストが成功する
- [x] テストが独立して実行可能（テスト間の依存がない）

## テスト結果サマリー

```
48 passed (9.6s)
- app.spec.ts: 10 テスト
- navigation.spec.ts: 10 テスト
- gallery.spec.ts: 7 テスト
- collections.spec.ts: 5 テスト
- labels.spec.ts: 6 テスト
- import.spec.ts: 10 テスト
```

## 作業ログ

- 2026-02-08: タスク開始、現状調査完了
- 2026-02-08: navigation.spec.ts 作成・テスト通過
- 2026-02-08: gallery.spec.ts 作成・テスト通過
- 2026-02-08: collections.spec.ts 作成・テスト通過
- 2026-02-08: labels.spec.ts 作成・テスト通過
- 2026-02-08: import.spec.ts 作成・テスト通過
- 2026-02-08: 全テスト統合テスト完了（48テスト全てパス）
