# ストレージフォルダ再選択設定画面の追加

## 関連 Issue

- https://github.com/mizunashi-mana/picstash/issues/202

## 目的・ゴール

デスクトップアプリで、初回セットアップ後にストレージフォルダを変更できる設定画面を追加する。

**背景**:
- 現在、ストレージフォルダは初回起動時にのみ選択可能
- フォルダを移動したい場合や、別のドライブに変更したい場合に対応できない
- ユーザーが誤って不適切なフォルダを選んだ場合に修正手段がない

## 実装方針

### アプローチ

シンプルな設定画面を追加し、メニューからアクセスできるようにする。

1. **設定ページの追加** (`/settings`):
   - 現在のストレージパスを表示
   - 「フォルダを変更」ボタンで再選択ダイアログを表示
   - 変更後はデータの再読み込みを実行（アプリ全体をリセット）

2. **ナビゲーションへの追加**:
   - AppLayout のメニューに「設定」リンクを追加
   - またはヘッダーに設定アイコンを追加

3. **既存実装の活用**:
   - `StorageManager.selectPath()` は既に実装済み
   - IPC ハンドラ `STORAGE_SELECT_PATH` も実装済み
   - フォルダ変更後は `coreManager.teardown()` → `coreManager.initialize()` が自動で呼ばれる

### 変更後の動作

フォルダ変更後は、アプリの状態をリセットして新しいライブラリを読み込む:
- React Query のキャッシュをクリア
- ホーム画面に遷移
- ストレージ状態を再チェック

### データ移行について

Issue の提案通り、既存データの移行は行わない（新しいフォルダとして扱う）。
移行オプションは将来の拡張として検討可能。

## 完了条件

- [x] 設定ページ (`/settings`) が追加されている
- [x] 現在のストレージパスが表示される
- [x] 「フォルダを変更」ボタンでダイアログが開く
- [x] フォルダ変更後にアプリが新しいライブラリを読み込む
- [x] ナビゲーションから設定画面にアクセスできる
- [ ] E2E テストが追加されている（任意）

## 作業ログ

### 2026-02-08

**実装完了**

1. **SettingsPage コンポーネントを作成**
   - `packages/desktop-app/src/renderer/features/settings/pages/SettingsPage.tsx`
   - 現在のストレージパスを表示
   - 「フォルダを変更」ボタンで `selectPath()` を呼び出し
   - 変更後は `window.location.reload()` でアプリをリセット
   - 警告メッセージ: 「既存のデータは移行されません」

2. **ルートを追加**
   - `packages/desktop-app/src/renderer/routes/index.tsx` に `/settings` ルートを追加

3. **ナビゲーションに追加**
   - `packages/desktop-app/src/renderer/shared/components/AppLayout.tsx` に「設定」リンクを追加
   - `IconSettings` アイコンを使用

4. **動作確認**
   - 型チェック: OK
   - リント: OK（既存の警告のみ）
   - ビルド: OK
